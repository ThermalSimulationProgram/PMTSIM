function TM = ARM3TM()



TM.n = 3;			% number of cores
TM.N = 24;			% number of nodes



%% model matrices and vectors

TM.INVC = diag([6.53714939429225 ;6.53714939429225 ;6.53714939429225 ;500.50050050050044...
    ;500.50050050050044 ;500.50050050050044 ;281.97211295802845 ;281.97211295802845 ;...
    281.97211295802845 ;28.20549328308442 ;28.20549328308442 ;28.20549328308442 ;2728.76238346478840...
    ;2728.76238346478840 ;2728.76238346478840 ;2728.76238346478840 ;272.95638661049412 ;...
    272.95638661049412 ;272.95638661049412 ;272.95638661049412 ;256.41357530076721 ;...
    256.41357530076721 ;256.41357530076721 ;256.41357530076721 ]);

SplusG = [4.78928571, -1.57500000, 0.00000000, -3.21428571, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000;-1.57500000, 6.36428571, -1.57500000, 0.00000000, -3.21428571,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000;0.00000000, -1.57500000, 4.78928571, 0.00000000, 0.00000000,...
    -3.21428571, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000;-3.21428571, 0.00000000, 0.00000000, 18.21452571, -0.00024000,...
    0.00000000, -15.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000;0.00000000, -3.21428571, 0.00000000, -0.00024000, 18.21476571,...
    -0.00024000, 0.00000000, -15.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000;0.00000000, 0.00000000, -3.21428571, 0.00000000, -0.00024000,...
    18.21452571, 0.00000000, 0.00000000, -15.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000;0.00000000, 0.00000000, 0.00000000, -15.00000000, 0.00000000,...
    0.00000000, 765.15605907, -0.04800000, 0.00000000, -750.00000000, 0.00000000,...
    0.00000000, -0.01032804, -0.01032804, 0.00000000, -0.08740299, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000, -15.00000000,...
    0.00000000, -0.04800000, 765.11665608, -0.04800000, 0.00000000, -750.00000000,...
    0.00000000, -0.01032804, -0.01032804, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -15.00000000, 0.00000000, ...
    -0.04800000, 765.15605907, 0.00000000, 0.00000000, -750.00000000, -0.01032804, -0.01032804, -0.08740299, 0.00000000, 0.00000000, ...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, -750.00000000, 0.00000000, 0.00000000, 750.16876694, -0.01200000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, -0.00258201, -0.00258201, 0.00000000, -0.02185075, 0.00000000, 0.00000000, 0.00000000, 0.00000000;0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -750.00000000, 0.00000000, -0.01200000, 750.15891619,...
    -0.01200000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00258201, -0.00258201, 0.00000000, 0.00000000, 0.00000000, ...
    0.00000000, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, ...
    0.00000000, -750.00000000, 0.00000000, -0.01200000, 750.16876694, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00258201,...
    -0.00258201, -0.02185075, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, -0.01032804, -0.01032804, -0.01032804, 0.00000000, 0.00000000, 0.00000000, 77.53098413,...
    0.00000000, 0.00000000, 0.00000000, -77.50000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, ...
    0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.01032804, -0.01032804, -0.01032804, ...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 77.53098413, 0.00000000, 0.00000000, 0.00000000, -77.50000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, ...
    0.00000000, 0.00000000, 0.00000000, -0.08740299, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 77.58740299,...
    0.00000000, 0.00000000, 0.00000000, -77.50000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000;0.00000000, ...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.08740299, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 77.58740299, 0.00000000, 0.00000000, 0.00000000, -77.50000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, -0.00258201, -0.00258201, -0.00258201, -77.50000000, 0.00000000, 0.00000000, 0.00000000, 77.64912251, 0.00000000, ...
    0.00000000, 0.00000000, -0.12796875, 0.00000000, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.00258201, -0.00258201, -0.00258201, 0.00000000, -77.50000000, 0.00000000, 0.00000000,...
    0.00000000, 77.64912251, 0.00000000, 0.00000000, 0.00000000, -0.12796875, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.02185075, 0.00000000, 0.00000000,...
    -77.50000000, 0.00000000, 0.00000000, 0.00000000, 77.66322722, 0.00000000, 0.00000000, 0.00000000, -0.12796875, 0.00000000;0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.02185075, 0.00000000, 0.00000000, ...
    0.00000000, 0.00000000, 0.00000000, -77.50000000, 0.00000000, 0.00000000, 0.00000000, 77.66322722, 0.00000000, 0.00000000, 0.00000000,...
    -0.12796875;0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.12796875, 0.00000000, 0.00000000, 0.00000000, 0.14224149,...
    0.00000000, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.12796875, 0.00000000,...
    0.00000000, 0.00000000, 0.14224149, 0.00000000, 0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, -0.12796875, 0.00000000, 0.00000000, 0.00000000, 0.14224149, 0.00000000;0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000,...
    0.00000000, 0.00000000, 0.00000000, 0.00000000, -0.12796875, 0.00000000, 0.00000000, 0.00000000, 0.14224149];

StimesT0 = [0.00000000000000 ;0.00000000000000 ;0.00000000000000 ;0.00000000000000 ;0.00000000000000 ;0.00000000000000 ;0.00000000000000 ;...
    0.00000000000000 ;0.00000000000000 ;38.92565200467107 ;38.92565200467107 ;38.92565200467107 ;0.00000000000000 ;0.00000000000000 ;...
    0.00000000000000 ;0.00000000000000 ;4.02231737381601 ;4.02231737381601 ;4.02231737381601 ;4.02231737381601 ;4.28182172051382 ;...
    4.28182172051382 ;4.28182172051382 ;4.28182172051382 ];



alpha_a = diag([0.022755102063125 0.022755102063124998 0.022755102063124998 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]);

alpha_i = diag([0.022755102063125 0.022755102063124998 0.022755102063124998 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]);

beta_a = [8.061353078616783; 8.061353078616783; 8.061353078616783; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];

beta_i = [-5.512180221383218; -5.512180221383218; -5.512180221383218; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0];


TM.A_a = (SplusG - alpha_a);   	% linear coefficient of DE in active mode
TM.A_i = (SplusG - alpha_i);   	% linear coefficient of DE in idle mode
TM.B_a = (beta_a + StimesT0);   	% constant of DE in active mode
TM.B_i = (beta_i + StimesT0);   	% constant of DE in idle mode

TM.initT = TM.A_i\TM.B_i;              % steady state temperature in idle mode



